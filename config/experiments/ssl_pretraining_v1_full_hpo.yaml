# HPO-tuned full-scale SSL pretraining (v1)

extends: base.yaml

experiment_name: "ssl_pretraining_v1_full_hpo"
description: "Full SSL pretraining v1 with HPO-tuned LR/warmup/CPC weight."

training:
  # HPO-tuned core hyperparameters
  learning_rate: 7.3e-5
  embedder_lr: 1.5e-5
  weight_decay: 0.0084

  scheduler:
    warmup_steps: 2000

  initial_loss_weights:
    cpc: 0.27

  # Longer schedule
  max_steps: 150000

  # Validation schedule
  validation_freq: 5000
  full_validation_freq: 50000

  early_stopping:
    enabled: true
    monitor: "val_raw_total_loss"
    min_delta: 0.01
    patience: 40000
    mode: "min"

  checkpoint:
    monitor: "val_raw_total_loss"
    mode: "min"
    save_best_only: false
    save_freq: 10000

monitoring:
  enabled: true
  save_attention_patterns: true
  attention_save_freq: 10000
  visualization_freq: 10000
  grad_stats_freq: 1000
