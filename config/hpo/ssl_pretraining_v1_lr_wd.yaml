# config/hpo/ssl_pretraining_v1_lr_wd.yaml
#
# Hyperparameter search definition for v1 SSL pretraining.
# Focuses on coarse-grained knobs: learning rates, weight decay, warmup, and CPC loss weight.

study:
  name: "ssl_pretraining_v1_lr_wd"
  direction: "minimize"                         # Optimize for lower validation loss
  storage: "sqlite:///outputs/hpo/studies/ssl_pretraining_v1_lr_wd.db"
  sampler:
    type: "tpe"
    seed: 42
  pruner:
    type: "median"
    n_startup_trials: 5
    n_warmup_steps: 0
    interval_steps: 1

objective:
  base_config: "config/experiments/ssl_pretraining_v1_hpo_base.yaml"
  metric: "raw_total_loss"
  max_trials: 50
  timeout: null                                   # Seconds; null disables timeout
  experiment_name_prefix: "ssl_v1_hpo"
  outputs_root: "outputs/hpo"
  resume_study: false

search_space:
  # Learning rate for main model parameters
  training.learning_rate:
    type: "float"
    low: 3.0e-5
    high: 3.0e-4
    log: true

  # Learning rate for pretrained embedders
  training.embedder_lr:
    type: "float"
    low: 3.0e-6
    high: 3.0e-5
    log: true

  # AdamW weight decay
  training.weight_decay:
    type: "float"
    low: 1.0e-4
    high: 1.0e-1
    log: true

  # Warmup steps for cosine scheduler
  training.scheduler.warmup_steps:
    type: "int"
    low: 2000
    high: 12000
    step: 1000

  # Initial CPC loss weight
  training.initial_loss_weights.cpc:
    type: "float"
    low: 0.25
    high: 2.0
    log: true
